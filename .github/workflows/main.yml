                                                                                                                                                                                                                                                                                              else
                                                                                                                                                                                                                                                                                                          echo "❌ Erro na execução do workflow"
                                                                                                                                                                                                                                                                                                                      echo "$response"
                                                                                                                                                                                                                                                                                                                                  exit 1
name: Composio Meta Ads to Google Sheets Sync

on:
    schedule:
          # Executa a cada 2 minutos
              - cron: '*/2 * * * *'
                workflow_dispatch:
                      # Permite execução manual

                      jobs:
                          sync-meta-ads:
                                runs-on: ubuntu-latest
                                    
                                    steps:
                                            - name: Checkout repository
                                                    uses: actions/checkout@v4
                                                            
                                                          - name: Setup Python
                                                                  uses: actions/setup-python@v4
                                                                          with:
                                                                                      python-version: '3.9'
                                                                                                
                                                                                            - name: Install dependencies
                                                                                                    run: |
                                                                                                              pip install requests
                                                                                                                        
                                                                                                                    - name: Execute Composio API Call
                                                                                                                            env:
                                                                                                                                        COMPOSIO_API_KEY: ${{ secrets.COMPOSIO_API_KEY }}
                                                                                                                                                run: |ctrl+s
                                                                                                                                                          response=$(curl -s -X POST "https://backend.composio.dev/api/v1/triggers/execute" \
                                                                                                                                                                      -H "Authorization: Bearer $COMPOSIO_API_KEY" \
                                                                                                                                                                                  -H "Content-Type: application/json" \
                                                                                                                                                                                              -d '{
                                                                                                                                                                                                            "input": {
                                                                                                                                                                                                                              "trigger_type": "github_actions_scheduled"
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                          }')
                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                    echo "Resposta da API Composio: $response"
                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                              # Verifica se a execução foi bem-sucedida
                                                                                                                                                                                                                                                                        if echo "$response" | grep -q '"status":"success"'; then
                                                                                                                                                                                                                                                                                    echo "✅ Workflow executado com sucesso!"
                                                                                                                                                                                                                                                                                              else
                                                                                                                                                                                                                                                                                                          echo "❌ Erro na execução do workflow"
                                                                                                                                                                                                                                                                                                                      echo "$response"
                                                                                                                                                                                                                                                                                                                                  exit 1
                                                                                                                                                                                                                                                                                                                                            fi'}}')